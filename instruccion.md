INSTRUCCIONES PARA LA IA EJECUTORATu tarea tiene tres pasos:CONSTRUIR los artefactos de software locales.DOCUMENTAR esos artefactos rellenando la plantilla.PUBLICAR todo en un repositorio de GitHub.TAREA 1: CONSTRUIR LOS ARTEFACTOS DEL PROYECTOCrea un repositorio de GitHub público (pero no hagas push aún) y prepara los siguientes ficheros localmente:/
|-- docker-compose.yml
|-- custom-rules/
|   |-- 001-windows-docs_rules.xml
|   |-- 002-linux-wordpress_rules.xml
|-- README.md (Este estará vacío por ahora)
1.1. docker-compose.ymlCrea un fichero docker-compose.yml que despliegue el stack completo de Wazuh (Wazuh Manager, Wazuh Indexer, y Wazuh Dashboard).Utiliza las imágenes oficiales de Wazuh (ej: wazuh/wazuh-manager, wazuh/wazuh-indexer, wazuh/wazuh-dashboard).Asegúrate de montar el directorio local ./custom-rules dentro del contenedor del wazuh-manager en la ruta /var/ossec/etc/rules/.1.2. custom-rules/001-windows-docs_rules.xmlEscribe una regla de Wazuh (formato XML) que genere una alerta de Nivel 10 (Alta Prioridad) cuando se detecte cualquier modificación (creación, borrado o escritura) en la carpeta C:\Users\*\Documentos y sus subdirectorios en cualquier agente Windows.Propósito: Monitorear la carpeta "Documentos" del usuario.1.3. custom-rules/002-linux-wordpress_rules.xmlEscribe una regla de Wazuh (formato XML) que genere una alerta de Nivel 12 (Crítica) cuando se detecte un intento de inicio de sesión fallido (evento wp-login-failed o similar) en un log de WordPress.Configuración del Agente (Asumida): Asume que el agente Wazuh en el servidor Linux está configurado para leer los logs del contenedor de WordPress (ej. montando el log de Docker o un access.log de Apache/Nginx que muestre los POST a wp-login.php).Propósito: Monitorear un contenedor Docker de WordPress en un servidor Linux.TAREA 2: DOCUMENTAR EL PROYECTO (MANUAL TÉCNICO)Toma la siguiente plantilla ((INICIO DE LA PLANTILLA)), rellena todas las secciones marcadas con [...COMPLETAR POR IA...] con la información real del repositorio y los ficheros que creaste en la TAREA 1.Este contenido generado será el que usarás para el fichero README.md.TAREA 3: PUBLICACIÓN FINALToma el texto del manual técnico generado en la TAREA 2 y guárdalo como el fichero README.md.Asegúrate de que tu repositorio local contenga todos los artefactos:docker-compose.ymlcustom-rules/001-windows-docs_rules.xmlcustom-rules/002-linux-wordpress_rules.xmlREADME.md (con el manual completo)Realiza el push final de todos estos ficheros al repositorio público de GitHub que creaste, en la rama principal (main o master).(INICIO DE LA PLANTILLA)Manual Técnico: Solución "Blue Sentinel" v1.0SIEM Contenerizado para Entidades Sin Ánimo de Lucro (ESAL)Documento: Manual Técnico de Arquitectura y FuncionalidadesVersión: 1.0 (Prototipo MVP)Repositorio del Proyecto: [...COMPLETAR POR IA: Inserta la URL al repositorio de GitHub que has creado...]1. INTRODUCCIÓN1.1. Propósito de este DocumentoEste manual técnico describe la arquitectura interna, los componentes tecnológicos, el diseño y las funcionalidades específicas de la solución "Blue Sentinel". Su propósito es servir como referencia técnica para el despliegue, mantenimiento y futura escalabilidad de la solución.1.2. Visión General de la Solución"Blue Sentinel" es una solución SIEM (Gestión de Eventos e Información de Seguridad) pre-configurada, diseñada para las ESAL en Colombia. Resuelve la barrera de complejidad "empaquetando" la plataforma Open Source Wazuh dentro de un entorno Docker e incluye reglas personalizadas para riesgos comunes.1.3. Glosario de TérminosSIEM: (Security Information and Event Management).Wazuh: Plataforma SIEM Open Source usada como núcleo.Docker: Plataforma de contenedores usada para el despliegue.Agente (Endpoint): Software de Wazuh instalado en los equipos a monitorear.Host: Máquina (servidor) donde se ejecutan los contenedores de Docker.FIM: (File Integrity Monitoring) Monitoreo de Integridad de Archivos.2. ARQUITECTURA DE LA SOLUCIÓN2.1. Filosofía de Diseño ("Empaquetamiento")Usabilidad sobre Complejidad: Se entregan reglas y dashboards pre-configurados.Despliegue Simple: El uso de docker-compose abstrae la instalación de los componentes de Wazuh en un solo comando (docker-compose up -d).2.2. Diagrama de Arquitectura de Alto Nivel[...COMPLETAR POR IA: Describe brevemente el flujo: Agentes (Windows/Linux) -> Red -> Host (Docker) -> Contenedores Wazuh (Manager/Indexer/Dashboard)...]2.3. Flujo de Datos (Agente -> Servidor -> Dashboard)El Agente Wazuh en un endpoint (ej. Windows) detecta un evento (ej. "Modificación en C:\Users\User\Documentos\file.txt").El Agente envía el log cifrado al wazuh-server (Contenedor Docker).El wazuh-server compara el log con las reglas en /var/ossec/etc/rules/, incluyendo 001-windows-docs_rules.xml.Al coincidir, genera una Alerta Nivel 10.La Alerta se envía al wazuh-indexer para almacenamiento.El usuario ve la Alerta en el wazuh-dashboard.3. DETALLE DE COMPONENTES ("STACK")3.1. Núcleo SIEM: WazuhVersión de Wazuh: [...COMPLETAR POR IA: Especifica la versión/tag de Wazuh usada en las imágenes de Docker, ej: 4.x.x...]Componentes: Wazuh Manager, Wazuh Indexer, Wazuh Dashboard.3.2. Plataforma de Contenerización: DockerLa solución se distribuye como un archivo docker-compose.yml.Imágenes Utilizadas:[...COMPLETAR POR IA: Imagen del Manager, ej: wazuh/wazuh-manager:4.x.x...][...COMPLETAR POR IA: Imagen del Indexer, ej: wazuh/wazuh-indexer:4.x.x...][...COMPLETAR POR IA: Imagen del Dashboard, ej: wazuh/wazuh-dashboard:4.x.x...]Contenido de docker-compose.yml:[...COMPLETAR POR IA: Pega aquí el contenido completo del fichero docker-compose.yml que has creado...]
3.3. Configuración de Red (Puertos Expuestos)443 (TCP): Acceso al Dashboard (HTTPS).1514 (TCP): Recepción de logs de los Agentes.1515 (TCP): Registro de nuevos Agentes.55000 (TCP): API de Wazuh.4. FUNCIONALIDAD PRE-CONFIGURADA (VALOR AGREGADO)Este es el núcleo de la innovación de "Blue Sentinel". La solución incluye reglas personalizadas (custom-rules) montadas automáticamente en el Wazuh Manager.4.1. Regla: (FIM - Windows "Documentos")Fichero: custom-rules/001-windows-docs_rules.xmlPropósito: Monitorear la carpeta C:\Users\*\Documentos en endpoints Windows.Nivel de Alerta: 10 (Alta Prioridad).Código de la Regla:[...COMPLETAR POR IA: Pega aquí el contenido completo del fichero 001-windows-docs_rules.xml que has creado...]
4.2. Regla: (Log - Linux/Docker WordPress)Fichero: custom-rules/002-linux-wordpress_rules.xmlPropósito: Monitorear logs de un contenedor WordPress en un host Linux para detectar intentos de login fallidos (wp-login-failed).Nivel de Alerta: 12 (Crítica).Código de la Regla:[...COMPLETAR POR IA: Pega aquí el contenido completo del fichero 002-linux-wordpress_rules.xml que has creado...]
Nota de Implementación del Agente: Para que esta regla funcione, el agente Wazuh en el host Linux debe estar configurado (en ossec.conf) para monitorear el log relevante, ej:<localfile>
  <log_format>apache</log_format>
  <location>/var/log/apache2/access.log</location>
</localfile>
5. ESPECIFICACIONES TÉCNICAS5.1. Requerimientos del Servidor (Host)[...COMPLETAR POR IA: Especifica los requisitos mínimos recomendados (RAM, CPU, Disco) para correr este stack de Docker. Ej: 8GB RAM, 4 vCPUs, 50GB Disco...]5.2. Requerimientos del Agente (Endpoint)Agente Wazuh v[...COMPLETAR POR IA: Versión del agente compatible...]Sistemas Soportados: Windows 10+, Windows Server 2016+, Ubuntu, CentOS, Debian, etc.5.3. Manifiesto de Archivos (Contenido del Paquete)[...COMPLETAR POR IA: Lista la estructura de archivos del repositorio que has creado...]6. MANTENIMIENTO Y CICLO DE VIDA6.1. Proceso de Actualización[...COMPLETAR POR IA: Describe brevemente cómo actualizar la solución (ej: docker-compose pull, docker-compose up -d)...]6.2. Estrategia de Backup[...COMPLETAR POR IA: Describe cómo hacer backup de los datos (ej: respaldando los volúmenes persistentes de Docker definidos en el docker-compose.yml)...]6.3. Limitaciones ConocidasLa configuración del agente (Endpoint) para leer los logs de WordPress (Regla 4.2) debe realizarse manualmente en cada host Linux.El monitoreo de FIM (Regla 4.1) puede generar alto "ruido" si la carpeta "Documentos" es usada intensivamente. Se recomienda ajustar la configuración en ossec.conf del agente si es necesario.(FIN DE LA PLANTILLA)